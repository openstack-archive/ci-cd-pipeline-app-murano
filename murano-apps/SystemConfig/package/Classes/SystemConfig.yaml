Namespaces:
  =: org.openstack.ci_cd_pipeline_murano_app.puppet
  sys: io.murano.system
  puppet: org.openstack.ci_cd_pipeline_murano_app.puppet

Name: SystemConfig
Properties:
  projectConfigRepo:
    Contract: $.string().notNull()
    Default: 'https://review.fuel-infra.org/open-paas/project-config'
  systemConfigRepo:
    Contract: $.string().notNull()
    Default: 'https://review.fuel-infra.org/open-paas/system-config'
  stableFlag:
    Contract: $.bool().notNull()
    Default: false
Methods:
  installOnTheNode:
    Arguments:
      instance:
        Contract: $.class(puppet:PuppetInstance)
    Body:
      - $resources: new(sys:Resources)
      - $template: $resources.yaml('SystemConfig.template').bind(dict(
            url => $this.systemConfigRepo,
            stable => $this.stableFlag))
      - $instance.agent.call($template, $resources)
      - $instance.putHieraData({'project_config_repo' => $this.projectConfigRepo})
      - $instance.installPuppetModule('reidmv/yamlfile')
